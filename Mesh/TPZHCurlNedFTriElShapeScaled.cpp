/**
 * @file
 * @brief Contains the implementation of the TPZHCurlNedFTriEl::Shape method.
 */

#ifdef HCURL_HIERARCHICAL_SCALED
#include "pzshapetriang.h"

using namespace pzshape;

void TPZHCurlNedFTriEl::CalcShape(TPZVec<REAL> &qsi, TPZFMatrix<REAL> &phi,
                              TPZFMatrix<REAL> &curlPhiHat, TPZVec<int> &order, TPZVec<int> nShapeF){



    const int dim = TPZShapeTriang::Dimension;
    const int nCon = order.size();
    const int firstSide = TPZShapeTriang::NSides - TPZShapeTriang::NFaces - 1;

    TPZManVector<int, 4> firstConFuncPos(nCon, 0);
    for (int iCon = 1; iCon < nCon; iCon++) {
        firstConFuncPos[iCon] = firstConFuncPos[iCon - 1] + nShapeF[iCon - 1];
    }
    int lastFuncPos = firstConFuncPos[nCon - 1] + nShapeF[nCon - 1] - 1;

    phi.Resize(lastFuncPos + 1, dim);
    curlPhiHat.Resize(1, lastFuncPos + 1);
    for (int iCon = 0; iCon < nCon; iCon++) {
        const int pOrder = order[iCon];
        const int side =
            iCon + TPZShapeTriang::NSides -
            TPZShapeTriang::NumSides(TPZShapeTriang::Dimension - 1) - 1;
        int currentFuncPos = firstConFuncPos[iCon] + nShapeF[iCon] - 1;
        switch (side) {
        case firstSide:
            switch (pOrder) {
            case 5:
                phi(currentFuncPos, 0) =
                    -((70 * pow(qsi[0], 4) +
                       140 * pow(qsi[0], 3) * (-1 + qsi[1]) +
                       90 * pow(qsi[0], 2) * pow(-1 + qsi[1], 2) +
                       20 * qsi[0] * pow(-1 + qsi[1], 3) +
                       pow(-1 + qsi[1], 4)) *
                      (-3 + 5 * qsi[1])) /
                    3.;
                phi(currentFuncPos, 1) =
                    (qsi[0] *
                     (350 * pow(qsi[0], 4) +
                      pow(-1 + qsi[1], 3) * (-13 + 5 * qsi[1]) +
                      20 * qsi[0] * pow(-1 + qsi[1], 2) * (-8 + 5 * qsi[1]) +
                      70 * pow(qsi[0], 3) * (-11 + 10 * qsi[1]) +
                      30 * pow(qsi[0], 2) *
                          (19 - 34 * qsi[1] + 15 * pow(qsi[1], 2)))) /
                    3.;
                curlPhiHat(0, currentFuncPos) =
                    10 *
                    (70 * pow(qsi[0], 4) +
                     140 * pow(qsi[0], 3) * (-1 + qsi[1]) +
                     90 * pow(qsi[0], 2) * pow(-1 + qsi[1], 2) +
                     20 * qsi[0] * pow(-1 + qsi[1], 3) + pow(-1 + qsi[1], 4));
                currentFuncPos--;
            case 4:
                phi(currentFuncPos, 0) =
                    -((20 * pow(qsi[0], 3) +
                       30 * pow(qsi[0], 2) * (-1 + qsi[1]) +
                       12 * qsi[0] * pow(-1 + qsi[1], 2) +
                       pow(-1 + qsi[1], 3)) *
                      (-5 + 8 * qsi[1])) /
                    5.;
                phi(currentFuncPos, 1) =
                    (qsi[0] *
                     (160 * pow(qsi[0], 3) +
                      pow(-1 + qsi[1], 2) * (-17 + 8 * qsi[1]) +
                      30 * pow(qsi[0], 2) * (-9 + 8 * qsi[1]) +
                      12 * qsi[0] * (11 - 19 * qsi[1] + 8 * pow(qsi[1], 2)))) /
                    5.;
                curlPhiHat(0, currentFuncPos) =
                    8 *
                    (20 * pow(qsi[0], 3) + 30 * pow(qsi[0], 2) * (-1 + qsi[1]) +
                     12 * qsi[0] * pow(-1 + qsi[1], 2) + pow(-1 + qsi[1], 3));
                currentFuncPos--;
            case 3:
                phi(currentFuncPos, 0) =
                    -((6 * pow(qsi[0], 2) + 6 * qsi[0] * (-1 + qsi[1]) +
                       pow(-1 + qsi[1], 2)) *
                      (-2 + 3 * qsi[1])) /
                    2.;
                phi(currentFuncPos, 1) =
                    (qsi[0] *
                     (5 + 18 * pow(qsi[0], 2) - 8 * qsi[1] +
                      3 * pow(qsi[1], 2) + 3 * qsi[0] * (-7 + 6 * qsi[1]))) /
                    2.;
                curlPhiHat(0, currentFuncPos) =
                    6 * (6 * pow(qsi[0], 2) + 6 * qsi[0] * (-1 + qsi[1]) +
                         pow(-1 + qsi[1], 2));
                currentFuncPos--;
            case 2:
                phi(currentFuncPos, 0) =
                    -((-1 + 2 * qsi[0] + qsi[1]) * (-3 + 4 * qsi[1])) / 3.;
                phi(currentFuncPos, 1) =
                    (qsi[0] * (-5 + 8 * qsi[0] + 4 * qsi[1])) / 3.;
                curlPhiHat(0, currentFuncPos) = 4 * (-1 + 2 * qsi[0] + qsi[1]);
                currentFuncPos--;
            case 1:
                phi(currentFuncPos, 0) = 1 - qsi[1];
                phi(currentFuncPos, 1) = qsi[0];
                curlPhiHat(0, currentFuncPos) = 2;
                break;
            default:
                DebugStop();//polynomial order not implemented
                break;
            }
			break;
        case firstSide + 1:
            switch (pOrder) {
            case 5:
                phi(currentFuncPos, 0) =
                    -(qsi[1] *
                      (5 * pow(qsi[0], 4) + pow(qsi[0], 3) * (8 - 80 * qsi[1]) +
                       8 * qsi[0] * (3 - 10 * qsi[1]) * pow(qsi[1], 2) +
                       pow(qsi[1], 3) * (-2 + 5 * qsi[1]) +
                       36 * pow(qsi[0], 2) * qsi[1] * (-1 + 5 * qsi[1]))) /
                    3.;
                phi(currentFuncPos, 1) =
                    (qsi[0] *
                     (5 * pow(qsi[0], 4) + pow(qsi[1], 3) * (8 + 5 * qsi[1]) +
                      12 * pow(qsi[0], 2) * qsi[1] * (2 + 15 * qsi[1]) -
                      4 * qsi[0] * pow(qsi[1], 2) * (9 + 20 * qsi[1]) -
                      2 * pow(qsi[0], 3) * (1 + 40 * qsi[1]))) /
                    3.;
                curlPhiHat(0, currentFuncPos) =
                    10 * (pow(qsi[0], 4) - 16 * pow(qsi[0], 3) * qsi[1] +
                          36 * pow(qsi[0], 2) * pow(qsi[1], 2) -
                          16 * qsi[0] * pow(qsi[1], 3) + pow(qsi[1], 4));
                currentFuncPos--;
            case 4:
                phi(currentFuncPos, 0) =
                    (qsi[1] *
                     (8 * pow(qsi[0], 3) + pow(qsi[0], 2) * (9 - 72 * qsi[1]) +
                      (3 - 8 * qsi[1]) * pow(qsi[1], 2) +
                      18 * qsi[0] * qsi[1] * (-1 + 4 * qsi[1]))) /
                    5.;
                phi(currentFuncPos, 1) =
                    (qsi[0] * (-8 * pow(qsi[0], 3) -
                               18 * qsi[0] * qsi[1] * (1 + 4 * qsi[1]) +
                               pow(qsi[1], 2) * (9 + 8 * qsi[1]) +
                               pow(qsi[0], 2) * (3 + 72 * qsi[1]))) /
                    5.;
                curlPhiHat(0, currentFuncPos) =
                    -8 * (pow(qsi[0], 3) - 9 * pow(qsi[0], 2) * qsi[1] +
                          9 * qsi[0] * pow(qsi[1], 2) - pow(qsi[1], 3));
                currentFuncPos--;
            case 3:
                phi(currentFuncPos, 0) =
                    (qsi[1] *
                     (-3 * pow(qsi[0], 2) + qsi[1] - 3 * pow(qsi[1], 2) +
                      2 * qsi[0] * (-1 + 6 * qsi[1]))) /
                    2.;
                phi(currentFuncPos, 1) =
                    (qsi[0] * (3 * pow(qsi[0], 2) + qsi[1] * (2 + 3 * qsi[1]) -
                               qsi[0] * (1 + 12 * qsi[1]))) /
                    2.;
                curlPhiHat(0, currentFuncPos) =
                    6 * (pow(qsi[0], 2) - 4 * qsi[0] * qsi[1] + pow(qsi[1], 2));
                currentFuncPos--;
            case 2:
                phi(currentFuncPos, 0) =
                    ((1 + 4 * qsi[0] - 4 * qsi[1]) * qsi[1]) / 3.;
                phi(currentFuncPos, 1) =
                    (qsi[0] * (1 - 4 * qsi[0] + 4 * qsi[1])) / 3.;
                curlPhiHat(0, currentFuncPos) = -4 * qsi[0] + 4 * qsi[1];
                currentFuncPos--;
            case 1:
                phi(currentFuncPos, 0) = -qsi[1];
                phi(currentFuncPos, 1) = qsi[0];
                curlPhiHat(0, currentFuncPos) = 2;
                break;
            default:
                DebugStop();
                break;
            }
			break;
        case firstSide + 2:
            switch (pOrder) {
            case 5:
                phi(currentFuncPos, 0) =
                    -(qsi[1] * (13 + 5 * pow(qsi[0], 4) - 160 * qsi[1] +
                                570 * pow(qsi[1], 2) - 770 * pow(qsi[1], 3) +
                                350 * pow(qsi[1], 4) +
                                4 * pow(qsi[0], 3) * (-7 + 25 * qsi[1]) +
                                18 * pow(qsi[0], 2) *
                                    (3 - 20 * qsi[1] + 25 * pow(qsi[1], 2)) +
                                4 * qsi[0] *
                                    (-11 + 105 * qsi[1] - 255 * pow(qsi[1], 2) +
                                     175 * pow(qsi[1], 3)))) /
                    3.;
                phi(currentFuncPos, 1) =
                    ((-3 + 5 * qsi[0]) *
                     (1 + pow(qsi[0], 4) - 20 * qsi[1] + 90 * pow(qsi[1], 2) -
                      140 * pow(qsi[1], 3) + 70 * pow(qsi[1], 4) +
                      4 * pow(qsi[0], 3) * (-1 + 5 * qsi[1]) +
                      pow(qsi[0], 2) * (6 - 60 * qsi[1] + 90 * pow(qsi[1], 2)) +
                      4 * qsi[0] *
                          (-1 + 15 * qsi[1] - 45 * pow(qsi[1], 2) +
                           35 * pow(qsi[1], 3)))) /
                    3.;
                curlPhiHat(0, currentFuncPos) =
                    10 *
                    (1 + pow(qsi[0], 4) - 20 * qsi[1] + 90 * pow(qsi[1], 2) -
                     140 * pow(qsi[1], 3) + 70 * pow(qsi[1], 4) +
                     4 * pow(qsi[0], 3) * (-1 + 5 * qsi[1]) +
                     pow(qsi[0], 2) * (6 - 60 * qsi[1] + 90 * pow(qsi[1], 2)) +
                     4 * qsi[0] *
                         (-1 + 15 * qsi[1] - 45 * pow(qsi[1], 2) +
                          35 * pow(qsi[1], 3)));
                currentFuncPos--;
            case 4:
                phi(currentFuncPos, 0) =
                    (qsi[1] *
                     (-17 + 8 * pow(qsi[0], 3) + 132 * qsi[1] -
                      270 * pow(qsi[1], 2) + 160 * pow(qsi[1], 3) +
                      pow(qsi[0], 2) * (-33 + 96 * qsi[1]) +
                      6 * qsi[0] * (7 - 38 * qsi[1] + 40 * pow(qsi[1], 2)))) /
                    5.;
                phi(currentFuncPos, 1) =
                    -((-5 + 8 * qsi[0]) *
                      (-1 + pow(qsi[0], 3) + 12 * qsi[1] - 30 * pow(qsi[1], 2) +
                       20 * pow(qsi[1], 3) +
                       3 * pow(qsi[0], 2) * (-1 + 4 * qsi[1]) +
                       3 * qsi[0] * (1 - 8 * qsi[1] + 10 * pow(qsi[1], 2)))) /
                    5.;
                curlPhiHat(0, currentFuncPos) =
                    -8 * (-1 + pow(qsi[0], 3) + 12 * qsi[1] -
                          30 * pow(qsi[1], 2) + 20 * pow(qsi[1], 3) +
                          3 * pow(qsi[0], 2) * (-1 + 4 * qsi[1]) +
                          3 * qsi[0] * (1 - 8 * qsi[1] + 10 * pow(qsi[1], 2)));
                currentFuncPos--;
            case 3:
                phi(currentFuncPos, 0) =
                    -(qsi[1] *
                      (5 + 3 * pow(qsi[0], 2) - 21 * qsi[1] +
                       18 * pow(qsi[1], 2) + 2 * qsi[0] * (-4 + 9 * qsi[1]))) /
                    2.;
                phi(currentFuncPos, 1) =
                    ((-2 + 3 * qsi[0]) *
                     (1 + pow(qsi[0], 2) - 6 * qsi[1] + 6 * pow(qsi[1], 2) +
                      qsi[0] * (-2 + 6 * qsi[1]))) /
                    2.;
                curlPhiHat(0, currentFuncPos) =
                    6 * (1 + pow(qsi[0], 2) - 6 * qsi[1] + 6 * pow(qsi[1], 2) +
                         qsi[0] * (-2 + 6 * qsi[1]));
                currentFuncPos--;
            case 2:
                phi(currentFuncPos, 0) =
                    (qsi[1] * (-5 + 4 * qsi[0] + 8 * qsi[1])) / 3.;
                phi(currentFuncPos, 1) =
                    -((-3 + 4 * qsi[0]) * (-1 + qsi[0] + 2 * qsi[1])) / 3.;
                curlPhiHat(0, currentFuncPos) = -4 * (-1 + qsi[0] + 2 * qsi[1]);
                currentFuncPos--;
            case 1:
                phi(currentFuncPos, 0) = -qsi[1];
                phi(currentFuncPos, 1) = -1 + qsi[0];
                curlPhiHat(0, currentFuncPos) = 2;
                break;
            default:
                DebugStop();
                break;
            }
			break;
        case firstSide + 3: // internal
            switch (pOrder) {
            case 5:
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (4.857575880682821 + 340.0303116477974 * pow(qsi[0], 4) +
                     437.1818292614538 * pow(qsi[0], 2) *
                         pow(1. - 1. * qsi[1], 2) -
                     19.430303522731283 * qsi[1] +
                     29.145455284096926 * pow(qsi[1], 2) -
                     19.430303522731283 * pow(qsi[1], 3) +
                     4.857575880682821 * pow(qsi[1], 4) +
                     97.1515176136564 * qsi[0] * pow(-1. + 1. * qsi[1], 3) +
                     pow(qsi[0], 3) *
                         (-680.0606232955948 + 680.0606232955948 * qsi[1]));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (-24.287879403414106 - 340.0303116477974 * pow(qsi[0], 4) +
                     pow(qsi[0], 3) *
                         (850.0757791194937 - 680.0606232955948 * qsi[1]) +
                     77.72121409092513 * qsi[1] -
                     87.43636585229078 * pow(qsi[1], 2) +
                     38.860607045462565 * pow(qsi[1], 3) -
                     4.857575880682821 * pow(qsi[1], 4) +
                     pow(qsi[0], 2) *
                         (-728.6363821024231 + 1165.818211363877 * qsi[1] -
                          437.18182926145386 * pow(qsi[1], 2)) +
                     qsi[0] * (242.87879403414107 - 582.9091056819385 * qsi[1] +
                               437.18182926145386 * pow(qsi[1], 2) -
                               97.15151761365642 * pow(qsi[1], 3)));
                curlPhiHat(0, currentFuncPos) =
                    -29.145455284096922 - 2040.1818698867846 * pow(qsi[0], 4) +
                    pow(qsi[0], 3) *
                        (4080.3637397735693 - 4080.3637397735693 * qsi[1]) -
                    2623.090975568723 * pow(qsi[0], 2) *
                        pow(1. - 1. * qsi[1], 2) +
                    116.5818211363877 * qsi[1] -
                    174.87273170458155 * pow(qsi[1], 2) +
                    116.5818211363877 * pow(qsi[1], 3) -
                    29.145455284096922 * pow(qsi[1], 4) +
                    qsi[0] * (582.9091056819385 - 1748.7273170458157 * qsi[1] +
                              1748.7273170458154 * pow(qsi[1], 2) -
                              582.9091056819384 * pow(qsi[1], 3));
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (7.67532481645995 + 191.8831204114988 * pow(qsi[0], 4) -
                     50.43784879387968 * qsi[1] +
                     105.26159748287932 * pow(qsi[1], 2) -
                     89.91094784995943 * pow(qsi[1], 3) +
                     27.411874344499825 * pow(qsi[1], 4) +
                     pow(qsi[0], 3) *
                         (-482.44898846319694 + 877.1799790239944 * qsi[1]) +
                     pow(qsi[0], 2) *
                         (394.73099056079747 - 1381.5584669627913 * qsi[1] +
                          986.8274764019937 * pow(qsi[1], 2)) +
                     qsi[0] *
                         (-114.03339727311928 + 578.9387861558363 * qsi[1] -
                          815.7773804923148 * pow(qsi[1], 2) +
                          350.8719916095978 * pow(qsi[1], 3)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (-25.21892439693984 - 191.8831204114988 * pow(qsi[0], 4) +
                     pow(qsi[0], 3) *
                         (537.2727371521966 - 877.1799790239944 * qsi[1]) +
                     162.27829611943898 * qsi[1] -
                     276.31169339255825 * pow(qsi[1], 2) +
                     166.66419601455894 * pow(qsi[1], 3) -
                     27.411874344499825 * pow(qsi[1], 4) +
                     pow(qsi[0], 2) *
                         (-526.3079874143966 + 1710.500959096789 * qsi[1] -
                          986.8274764019937 * pow(qsi[1], 2)) +
                     qsi[0] * (206.13729507063871 - 999.9851760873538 * qsi[1] +
                               1144.7198726263127 * pow(qsi[1], 2) -
                               350.8719916095978 * pow(qsi[1], 3)));
                curlPhiHat(0, currentFuncPos) =
                    -32.89424921339979 - 1151.2987224689925 * pow(qsi[0], 4) +
                    pow(qsi[0], 3) *
                        (2631.5399370719833 - 5263.079874143967 * qsi[1]) +
                    263.1539937071983 * qsi[1] -
                    592.0964858411962 * pow(qsi[1], 2) +
                    526.3079874143966 * pow(qsi[1], 3) -
                    164.47124606699896 * pow(qsi[1], 4) +
                    pow(qsi[0], 2) *
                        (-1973.6549528039873 + 7894.619811215949 * qsi[1] -
                         5920.964858411962 * pow(qsi[1], 2)) +
                    qsi[0] * (526.3079874143966 - 3157.8479244863797 * qsi[1] +
                              4736.77188672957 * pow(qsi[1], 2) -
                              2105.2319496575865 * pow(qsi[1], 3));
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (9.077694349578715 + 75.64745291315596 * pow(qsi[0], 4) -
                     78.67335102968222 * qsi[1] +
                     205.76107192378421 * pow(qsi[1], 2) -
                     211.8128681568367 * pow(qsi[1], 3) +
                     75.64745291315596 * pow(qsi[1], 4) +
                     pow(qsi[0], 3) *
                         (-242.07184932209907 + 605.1796233052477 * qsi[1]) +
                     pow(qsi[0], 2) *
                         (254.17544178820404 - 1198.2556541443905 * qsi[1] +
                          1089.323321949446 * pow(qsi[1], 2)) +
                     qsi[0] * (-96.82873972883964 + 653.5939931696676 * qsi[1] -
                               1161.9448767460756 * pow(qsi[1], 2) +
                               605.1796233052477 * pow(qsi[1], 3)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (-21.18128681568367 - 75.64745291315596 * pow(qsi[0], 4) +
                     pow(qsi[0], 3) *
                         (242.07184932209907 - 605.1796233052477 * qsi[1]) +
                     205.76107192378421 * qsi[1] -
                     472.04010617809325 * pow(qsi[1], 2) +
                     363.10777398314866 * pow(qsi[1], 3) -
                     75.64745291315596 * pow(qsi[1], 4) +
                     pow(qsi[0], 2) *
                         (-278.38262672041395 + 1379.8095411359648 * qsi[1] -
                          1089.323321949446 * pow(qsi[1], 2)) +
                     qsi[0] * (133.1395171271545 - 980.3909897545013 * qsi[1] +
                               1525.0526507292245 * pow(qsi[1], 2) -
                               605.1796233052477 * pow(qsi[1], 3)));
                curlPhiHat(0, currentFuncPos) =
                    -30.258981165262384 - 453.8847174789358 * pow(qsi[0], 4) +
                    pow(qsi[0], 3) *
                        (1210.3592466104956 - 3631.077739831487 * qsi[1]) +
                    363.10777398314866 * qsi[1] -
                    1089.323321949446 * pow(qsi[1], 2) +
                    1210.3592466104956 * pow(qsi[1], 3) -
                    453.8847174789358 * pow(qsi[1], 4) +
                    pow(qsi[0], 2) *
                        (-1089.323321949446 + 6535.939931696676 * qsi[1] -
                         6535.939931696676 * pow(qsi[1], 2)) +
                    qsi[0] * (363.10777398314866 - 3267.969965848338 * qsi[1] +
                              6535.939931696676 * pow(qsi[1], 2) -
                              3631.077739831487 * pow(qsi[1], 3));
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (7.640802985396014 + 17.365461330445488 * pow(qsi[0], 4) -
                     80.57574057326705 * qsi[1] +
                     250.06264315841497 * pow(qsi[1], 2) -
                     298.68593488366236 * pow(qsi[1], 3) +
                     121.5582293131184 * pow(qsi[1], 4) +
                     pow(qsi[0], 3) *
                         (-72.24031913465322 + 222.27790502970223 * qsi[1]) +
                     pow(qsi[0], 2) *
                         (100.025057263366 - 575.1440792643546 * qsi[1] +
                          625.1566078960375 * pow(qsi[1], 2)) +
                     qsi[0] * (-52.79100244455428 + 433.4419148079193 * qsi[1] -
                               916.8963582475217 * pow(qsi[1], 2) +
                               555.6947625742556 * pow(qsi[1], 3)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (-13.19775061113857 - 17.365461330445488 * pow(qsi[0], 4) +
                     pow(qsi[0], 3) *
                         (65.29413460247503 - 222.27790502970223 * qsi[1]) +
                     172.2653763980192 * qsi[1] -
                     500.12528631683 * pow(qsi[1], 2) +
                     472.3405481881172 * pow(qsi[1], 3) -
                     121.5582293131184 * pow(qsi[1], 4) +
                     pow(qsi[0], 2) *
                         (-91.68963582475217 + 616.8211864574237 * qsi[1] -
                          625.1566078960375 * pow(qsi[1], 2)) +
                     qsi[0] * (56.9587131638612 - 566.8086578257406 * qsi[1] +
                               1125.2818942128672 * pow(qsi[1], 2) -
                               555.6947625742556 * pow(qsi[1], 3)));
                curlPhiHat(0, currentFuncPos) =
                    -20.83855359653458 - 104.1927679826729 * pow(qsi[0], 4) +
                    pow(qsi[0], 3) *
                        (333.4168575445533 - 1333.6674301782132 * qsi[1]) +
                    333.4168575445533 * qsi[1] -
                    1250.313215792075 * pow(qsi[1], 2) +
                    1667.084287722767 * pow(qsi[1], 3) -
                    729.3493758787104 * pow(qsi[1], 4) +
                    pow(qsi[0], 2) *
                        (-375.0939647376225 + 3000.75171790098 * qsi[1] -
                         3750.9396473762245 * pow(qsi[1], 2)) +
                    qsi[0] * (166.70842877227665 - 2000.5011452673198 * qsi[1] +
                              5001.2528631683 * pow(qsi[1], 2) -
                              3334.168575445533 * pow(qsi[1], 3));
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (-13.016296467337847 - 119.88694114653282 * pow(qsi[0], 4) +
                     pow(qsi[0], 3) *
                         (465.8463998836703 - 548.0545880984357 * qsi[1]) +
                     56.17559528008966 * qsi[1] -
                     90.42900703624188 * pow(qsi[1], 2) +
                     64.3964141015662 * pow(qsi[1], 3) -
                     17.126705878076116 * pow(qsi[1], 4) +
                     pow(qsi[0], 2) *
                         (-493.2491292885921 + 1109.8105408993322 * qsi[1] -
                          616.5614116107402 * pow(qsi[1], 2)) +
                     qsi[0] * (169.89692231051507 - 559.0156798604044 * qsi[1] +
                               608.3405927892636 * pow(qsi[1], 2) -
                               219.2218352393743 * pow(qsi[1], 3)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (7.535750586353491 + 119.8869411465328 * pow(qsi[0], 4) -
                     52.06518586935139 * qsi[1] +
                     98.64982585771843 * pow(qsi[1], 2) -
                     71.24709645279664 * pow(qsi[1], 3) +
                     17.126705878076116 * pow(qsi[1], 4) +
                     pow(qsi[0], 3) *
                         (-294.57934110290915 + 548.0545880984357 * qsi[1]) +
                     pow(qsi[0], 2) *
                         (246.62456464429604 - 904.2900703624189 * qsi[1] +
                          616.5614116107402 * pow(qsi[1], 2)) +
                     qsi[0] * (-79.46791527427317 + 427.4825787167798 * qsi[1] -
                               567.2364986818809 * pow(qsi[1], 2) +
                               219.2218352393743 * pow(qsi[1], 3)));
                curlPhiHat(0, currentFuncPos) =
                    20.55204705369134 + 719.3216468791968 * pow(qsi[0], 4) -
                    164.4163764295307 * qsi[1] +
                    369.936846966444 * pow(qsi[1], 2) -
                    328.83275285906143 * pow(qsi[1], 3) +
                    102.76023526845668 * pow(qsi[1], 4) +
                    pow(qsi[0], 3) *
                        (-1644.163764295307 + 3288.327528590614 * qsi[1]) +
                    pow(qsi[0], 2) *
                        (1233.1228232214803 - 4932.491292885921 * qsi[1] +
                         3699.3684696644405 * pow(qsi[1], 2)) +
                    qsi[0] *
                        (-328.83275285906143 + 1972.9965171543683 * qsi[1] -
                         2959.494775731553 * pow(qsi[1], 2) +
                         1315.3310114362455 * pow(qsi[1], 3));
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (-21.18128679659206 - 75.64745284497165 * pow(qsi[0], 4) +
                     pow(qsi[0], 3) *
                         (363.1077736558639 - 605.1796227597732 * qsi[1]) +
                     133.13951700715012 * qsi[1] -
                     278.3826264694957 * pow(qsi[1], 2) +
                     242.0718491039093 * pow(qsi[1], 3) -
                     75.64745284497165 * pow(qsi[1], 4) +
                     pow(qsi[0], 2) *
                         (-472.0401057526231 + 1525.0526493546286 * qsi[1] -
                          1089.3233209675918 * pow(qsi[1], 2)) +
                     qsi[0] * (205.7610717383229 - 980.3909888708326 * qsi[1] +
                               1379.8095398922828 * pow(qsi[1], 2) -
                               605.1796227597732 * pow(qsi[1], 3)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (9.077694341396597 + 75.64745284497165 * pow(qsi[0], 4) -
                     96.82873964156371 * qsi[1] +
                     254.17544155910474 * pow(qsi[1], 2) -
                     242.0718491039093 * pow(qsi[1], 3) +
                     75.64745284497165 * pow(qsi[1], 4) +
                     pow(qsi[0], 3) *
                         (-211.81286796592062 + 605.1796227597732 * qsi[1]) +
                     pow(qsi[0], 2) *
                         (205.7610717383229 - 1161.9448756987645 * qsi[1] +
                          1089.3233209675918 * pow(qsi[1], 2)) +
                     qsi[0] * (-78.6733509587705 + 653.5939925805551 * qsi[1] -
                               1198.255653064351 * pow(qsi[1], 2) +
                               605.1796227597732 * pow(qsi[1], 3)));
                curlPhiHat(0, currentFuncPos) =
                    30.258981137988663 + 453.88471706982995 * pow(qsi[0], 4) -
                    363.107773655864 * qsi[1] +
                    1089.3233209675918 * pow(qsi[1], 2) -
                    1210.3592455195464 * pow(qsi[1], 3) +
                    453.88471706982995 * pow(qsi[1], 4) +
                    pow(qsi[0], 3) *
                        (-1210.3592455195464 + 3631.077736558639 * qsi[1]) +
                    pow(qsi[0], 2) *
                        (1089.3233209675918 - 6535.939925805551 * qsi[1] +
                         6535.939925805551 * pow(qsi[1], 2)) +
                    qsi[0] * (-363.107773655864 + 3267.9699629027755 * qsi[1] -
                              6535.939925805551 * pow(qsi[1], 2) +
                              3631.077736558639 * pow(qsi[1], 3));
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (-25.21892437276793 - 27.411874318226005 * pow(qsi[0], 4) +
                     pow(qsi[0], 3) *
                         (166.66419585481412 - 350.8719912732929 * qsi[1]) +
                     206.13729487305963 * qsi[1] -
                     526.3079869099394 * pow(qsi[1], 2) +
                     537.2727366372297 * pow(qsi[1], 3) -
                     191.88312022758205 * pow(qsi[1], 4) +
                     pow(qsi[0], 2) *
                         (-276.3116931277182 + 1144.719871529118 * qsi[1] -
                          986.8274754561363 * pow(qsi[1], 2)) +
                     qsi[0] * (162.278295963898 - 999.9851751288849 * qsi[1] +
                               1710.500957457303 * pow(qsi[1], 2) -
                               877.1799781832322 * pow(qsi[1], 3)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (7.675324809103283 + 27.41187431822601 * pow(qsi[0], 4) -
                     114.0333971638202 * qsi[1] +
                     394.73099018245455 * pow(qsi[1], 2) -
                     482.4489880007778 * pow(qsi[1], 3) +
                     191.88312022758205 * pow(qsi[1], 4) +
                     pow(qsi[0], 3) *
                         (-89.91094776378131 + 350.8719912732929 * qsi[1]) +
                     pow(qsi[0], 2) *
                         (105.26159738198788 - 815.7773797104061 * qsi[1] +
                          986.8274754561363 * pow(qsi[1], 2)) +
                     qsi[0] * (-50.43784874553586 + 578.9387856009333 * qsi[1] -
                               1381.5584656385909 * pow(qsi[1], 2) +
                               877.1799781832323 * pow(qsi[1], 3)));
                curlPhiHat(0, currentFuncPos) =
                    32.89424918187121 + 164.47124590935604 * pow(qsi[0], 4) -
                    526.3079869099394 * qsi[1] +
                    1973.6549509122729 * pow(qsi[1], 2) -
                    2631.5399345496967 * pow(qsi[1], 3) +
                    1151.2987213654924 * pow(qsi[1], 4) +
                    pow(qsi[0], 3) *
                        (-526.3079869099394 + 2105.2319476397574 * qsi[1]) +
                    pow(qsi[0], 2) *
                        (592.0964852736818 - 4736.771882189454 * qsi[1] +
                         5920.964852736817 * pow(qsi[1], 2)) +
                    qsi[0] * (-263.1539934549697 + 3157.8479214596364 * qsi[1] -
                              7894.61980364909 * pow(qsi[1], 2) +
                              5263.079869099393 * pow(qsi[1], 3));
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (-24.28788014983027 - 4.857576029966053 * pow(qsi[0], 4) +
                     pow(qsi[0], 3) *
                         (38.86060823972842 - 97.15152059932107 * qsi[1]) +
                     242.87880149830264 * qsi[1] -
                     728.6364044949079 * pow(qsi[1], 2) +
                     850.0758052440592 * pow(qsi[1], 3) -
                     340.0303220976237 * pow(qsi[1], 4) +
                     pow(qsi[0], 2) *
                         (-87.43636853938897 + 437.1818426969447 * qsi[1] -
                          437.1818426969447 * pow(qsi[1], 2)) +
                     qsi[0] * (77.72121647945684 - 582.9091235959263 * qsi[1] +
                               1165.8182471918526 * pow(qsi[1], 2) -
                               680.0606441952474 * pow(qsi[1], 3)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (4.857576029966053 + 4.857576029966053 * pow(qsi[0], 4) -
                     97.15152059932106 * qsi[1] +
                     437.1818426969447 * pow(qsi[1], 2) -
                     680.0606441952474 * pow(qsi[1], 3) +
                     340.0303220976237 * pow(qsi[1], 4) +
                     pow(qsi[0], 3) *
                         (-19.43030411986421 + 97.15152059932106 * qsi[1]) +
                     pow(qsi[0], 2) *
                         (29.145456179796316 - 291.45456179796315 * qsi[1] +
                          437.1818426969447 * pow(qsi[1], 2)) +
                     qsi[0] *
                         (-19.43030411986421 + 291.45456179796315 * qsi[1] -
                          874.3636853938895 * pow(qsi[1], 2) +
                          680.0606441952474 * pow(qsi[1], 3)));
                curlPhiHat(0, currentFuncPos) =
                    29.145456179796312 + 29.145456179796312 * pow(qsi[0], 4) -
                    582.9091235959263 * qsi[1] +
                    2623.0910561816686 * pow(qsi[1], 2) -
                    4080.3638651714837 * pow(qsi[1], 3) +
                    2040.1819325857418 * pow(qsi[1], 4) +
                    pow(qsi[0], 3) *
                        (-116.58182471918528 + 582.9091235959263 * qsi[1]) +
                    pow(qsi[0], 2) *
                        (174.8727370787779 - 1748.727370787779 * qsi[1] +
                         2623.091056181668 * pow(qsi[1], 2)) +
                    qsi[0] * (-116.58182471918528 + 1748.727370787779 * qsi[1] -
                              5246.182112363336 * pow(qsi[1], 2) +
                              4080.3638651714846 * pow(qsi[1], 3));
                currentFuncPos--;
            case 4:
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (80.00000003843908 * pow(qsi[0], 3) +
                     48.00000002306345 * qsi[0] * pow(1. - 1. * qsi[1], 2) +
                     4.000000001921955 * pow(-1. + 1. * qsi[1], 3) +
                     pow(qsi[0], 2) *
                         (-120.00000005765862 + 120.00000005765862 * qsi[1]));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (16.000000007687817 - 80.00000003843908 * pow(qsi[0], 3) +
                     pow(qsi[0], 2) *
                         (160.00000007687817 - 120.00000005765862 * qsi[1]) -
                     36.00000001729759 * qsi[1] +
                     24.000000011531725 * pow(qsi[1], 2) -
                     4.000000001921954 * pow(qsi[1], 3) +
                     qsi[0] * (-96.0000000461269 + 144.00000006919035 * qsi[1] -
                               48.00000002306345 * pow(qsi[1], 2)));
                curlPhiHat(0, currentFuncPos) =
                    -400.00000019219544 * pow(qsi[0], 3) +
                    pow(qsi[0], 2) *
                        (600.0000002882932 - 600.0000002882932 * qsi[1]) -
                    240.00000011531725 * qsi[0] * pow(1. - 1. * qsi[1], 2) -
                    20.00000000960977 * pow(-1. + 1. * qsi[1], 3);
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (-5.7902279049222365 + 42.11074839943444 * pow(qsi[0], 3) +
                     28.42475516961825 * qsi[1] -
                     39.47882662446979 * pow(qsi[1], 2) +
                     16.84429935977378 * pow(qsi[1], 3) +
                     pow(qsi[0], 2) *
                         (-85.27426550885475 + 151.598694237964 * qsi[1]) +
                     qsi[0] *
                         (47.374591949363754 - 161.07361262783675 * qsi[1] +
                          113.699020678473 * pow(qsi[1], 2)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (15.265146294794986 - 42.11074839943444 * pow(qsi[0], 3) +
                     pow(qsi[0], 2) *
                         (97.90749002868509 - 151.598694237964 * qsi[1]) -
                     69.48273485906684 * qsi[1] +
                     71.06188792404562 * pow(qsi[1], 2) -
                     16.84429935977378 * pow(qsi[1], 3) +
                     qsi[0] *
                         (-71.06188792404562 + 217.92312296707325 * qsi[1] -
                          113.699020678473 * pow(qsi[1], 2)));
                curlPhiHat(0, currentFuncPos) =
                    21.05537419971722 - 210.55374199717224 * pow(qsi[0], 3) +
                    pow(qsi[0], 2) *
                        (378.99673559491 - 757.99347118982 * qsi[1]) -
                    126.33224519830334 * qsi[1] +
                    189.498367797455 * pow(qsi[1], 2) -
                    84.22149679886888 * pow(qsi[1], 3) +
                    qsi[0] * (-189.498367797455 + 757.99347118982 * qsi[1] -
                              568.4951033923651 * pow(qsi[1], 2));
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (-5.5076083323609915 + 12.588819045396551 * pow(qsi[0], 3) +
                     35.4060535651778 * qsi[1] -
                     61.37049284630819 * pow(qsi[1], 2) +
                     31.472047613491377 * pow(qsi[1], 3) +
                     pow(qsi[0], 2) *
                         (-35.4060535651778 + 84.97452855642672 * qsi[1]) +
                     qsi[0] * (28.32484285214224 - 127.46179283464006 * qsi[1] +
                               113.29937140856896 * pow(qsi[1], 2)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (10.228415474384699 - 12.588819045396551 * pow(qsi[0], 3) +
                     pow(qsi[0], 2) *
                         (35.4060535651778 - 84.97452855642672 * qsi[1]) -
                     70.8121071303556 * qsi[1] +
                     99.13694998249784 * pow(qsi[1], 2) -
                     31.472047613491377 * pow(qsi[1], 3) +
                     qsi[0] *
                         (-33.04564999416595 + 155.78663568678232 * qsi[1] -
                          113.29937140856896 * pow(qsi[1], 2)));
                curlPhiHat(0, currentFuncPos) =
                    15.736023806745692 - 62.94409522698275 * pow(qsi[0], 3) +
                    pow(qsi[0], 2) *
                        (141.6242142607112 - 424.87264278213365 * qsi[1]) -
                    141.6242142607112 * qsi[1] +
                    283.2484285214224 * pow(qsi[1], 2) -
                    157.3602380674569 * pow(qsi[1], 3) +
                    qsi[0] * (-94.41614284047414 + 566.4968570428448 * qsi[1] -
                              566.4968570428448 * pow(qsi[1], 2));
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (10.228415560233607 - 31.472047877641867 * pow(qsi[0], 3) +
                     pow(qsi[0], 2) *
                         (99.13695081457188 - 113.29937235951073 * qsi[1]) -
                     33.04565027152396 * qsi[1] +
                     35.4060538623471 * pow(qsi[1], 2) -
                     12.588819151056747 * pow(qsi[1], 3) +
                     qsi[0] * (-70.8121077246942 + 155.78663699432724 * qsi[1] -
                               84.97452926963304 * pow(qsi[1], 2)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (-5.507608378587326 + 31.472047877641867 * pow(qsi[0], 3) +
                     28.32484308987768 * qsi[1] -
                     35.4060538623471 * pow(qsi[1], 2) +
                     12.588819151056747 * pow(qsi[1], 3) +
                     pow(qsi[0], 2) *
                         (-61.37049336140164 + 113.29937235951073 * qsi[1]) +
                     qsi[0] * (35.4060538623471 - 127.46179390444955 * qsi[1] +
                               84.97452926963304 * pow(qsi[1], 2)));
                curlPhiHat(0, currentFuncPos) =
                    -15.736023938820933 + 157.36023938820932 * pow(qsi[0], 3) +
                    94.4161436329256 * qsi[1] -
                    141.6242154493884 * pow(qsi[1], 2) +
                    62.94409575528373 * pow(qsi[1], 3) +
                    pow(qsi[0], 2) *
                        (-283.2484308987768 + 566.4968617975536 * qsi[1]) +
                    qsi[0] * (141.6242154493884 - 566.4968617975536 * qsi[1] +
                              424.8726463481652 * pow(qsi[1], 2));
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (18.0147245924205 - 19.878316791636415 * pow(qsi[0], 3) +
                     pow(qsi[0], 2) *
                         (83.86164896471612 - 134.1786383435458 * qsi[1]) -
                     83.86164896471612 * qsi[1] +
                     115.54271635138666 * pow(qsi[1], 2) -
                     49.69579197909104 * pow(qsi[1], 3) +
                     qsi[0] *
                         (-81.99805676550021 + 257.17572349179613 * qsi[1] -
                          178.90485112472774 * pow(qsi[1], 2)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (-6.833171397125017 + 19.878316791636415 * pow(qsi[0], 3) +
                     55.907765976477414 * qsi[1] -
                     100.63397875765935 * pow(qsi[1], 2) +
                     49.69579197909104 * pow(qsi[1], 3) +
                     pow(qsi[0], 2) *
                         (-46.58980498039785 + 134.1786383435458 * qsi[1]) +
                     qsi[0] * (33.54465958588645 - 190.0864043200232 * qsi[1] +
                               178.90485112472774 * pow(qsi[1], 2)));
                curlPhiHat(0, currentFuncPos) =
                    -24.847895989545517 + 99.39158395818208 * pow(qsi[0], 3) +
                    223.63106390590963 * qsi[1] -
                    447.26212781181925 * pow(qsi[1], 2) +
                    248.47895989545515 * pow(qsi[1], 3) +
                    pow(qsi[0], 2) *
                        (-223.63106390590963 + 670.893191717729 * qsi[1]) +
                    qsi[0] * (149.08737593727312 - 894.5242556236387 * qsi[1] +
                              894.5242556236387 * pow(qsi[1], 2));
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (16.000000048648168 - 4.000000012162042 * pow(qsi[0], 3) +
                     pow(qsi[0], 2) *
                         (24.000000072972252 - 48.000000145944504 * qsi[1]) -
                     96.00000029188901 * qsi[1] +
                     160.00000048648167 * pow(qsi[1], 2) -
                     80.00000024324083 * pow(qsi[1], 3) +
                     qsi[0] * (-36.00000010945838 + 144.0000004378335 * qsi[1] -
                               120.00000036486126 * pow(qsi[1], 2)));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (-4.000000012162042 + 4.000000012162042 * pow(qsi[0], 3) +
                     48.000000145944504 * qsi[1] -
                     120.00000036486126 * pow(qsi[1], 2) +
                     80.00000024324083 * pow(qsi[1], 3) +
                     pow(qsi[0], 2) *
                         (-12.000000036486126 + 48.000000145944504 * qsi[1]) +
                     qsi[0] * (12.000000036486126 - 96.00000029188901 * qsi[1] +
                               120.00000036486126 * pow(qsi[1], 2)));
                curlPhiHat(0, currentFuncPos) =
                    -20.00000006081021 + 20.00000006081021 * pow(qsi[0], 3) +
                    240.00000072972253 * qsi[1] -
                    600.0000018243063 * pow(qsi[1], 2) +
                    400.0000012162042 * pow(qsi[1], 3) +
                    pow(qsi[0], 2) *
                        (-60.000000182430625 + 240.0000007297225 * qsi[1]) +
                    qsi[0] * (60.000000182430625 - 480.000001459445 * qsi[1] +
                              600.0000018243063 * pow(qsi[1], 2));
                currentFuncPos--;
            case 3:
                phi(currentFuncPos, 0) =
                    qsi[1] * (20.784610322150467 * pow(qsi[0], 2) +
                              3.464101720358411 * pow(1. - 1. * qsi[1], 2) +
                              qsi[0] * (-20.784610322150467 +
                                        20.784610322150467 * qsi[1]));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (-10.392305161075233 - 20.784610322150467 * pow(qsi[0], 2) +
                     qsi[0] * (31.1769154832257 - 20.784610322150467 * qsi[1]) +
                     13.856406881433644 * qsi[1] -
                     3.464101720358411 * pow(qsi[1], 2));
                curlPhiHat(0, currentFuncPos) =
                    -83.13844128860187 * pow(qsi[0], 2) +
                    qsi[0] * (83.13844128860187 - 83.13844128860187 * qsi[1]) -
                    13.856406881433644 * pow(1. - 1. * qsi[1], 2);
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (3.5890341788007496 + 8.075326902301686 * pow(qsi[0], 2) -
                     11.664361081102436 * qsi[1] +
                     8.075326902301686 * pow(qsi[1], 2) +
                     qsi[0] *
                         (-12.561619625802624 + 21.534205072804497 * qsi[1]));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (-7.178068357601499 - 8.075326902301686 * pow(qsi[0], 2) +
                     qsi[0] *
                         (15.253395259903186 - 21.534205072804497 * qsi[1]) +
                     19.739687983404124 * qsi[1] -
                     8.075326902301686 * pow(qsi[1], 2));
                curlPhiHat(0, currentFuncPos) =
                    -10.767102536402248 - 32.301307609206745 * pow(qsi[0], 2) +
                    qsi[0] * (43.06841014560899 - 86.13682029121799 * qsi[1]) +
                    43.06841014560899 * qsi[1] -
                    32.301307609206745 * pow(qsi[1], 2);
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (-7.17806835736355 - 8.075326902033993 * pow(qsi[0], 2) +
                     qsi[0] *
                         (19.739687982749764 - 21.53420507209065 * qsi[1]) +
                     15.253395259397543 * qsi[1] -
                     8.075326902033993 * pow(qsi[1], 2));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (3.589034178681775 + 8.075326902033993 * pow(qsi[0], 2) -
                     12.561619625386212 * qsi[1] +
                     8.075326902033993 * pow(qsi[1], 2) +
                     qsi[0] *
                         (-11.664361080715768 + 21.53420507209065 * qsi[1]));
                curlPhiHat(0, currentFuncPos) =
                    10.767102536045325 + 32.30130760813598 * pow(qsi[0], 2) -
                    43.0684101441813 * qsi[1] +
                    32.30130760813598 * pow(qsi[1], 2) +
                    qsi[0] * (-43.0684101441813 + 86.1368202883626 * qsi[1]);
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    qsi[1] *
                    (-10.392304847746402 - 3.4641016159154674 * pow(qsi[0], 2) +
                     qsi[0] *
                         (13.85640646366187 - 20.784609695492804 * qsi[1]) +
                     31.176914543239207 * qsi[1] -
                     20.784609695492804 * pow(qsi[1], 2));
                phi(currentFuncPos, 1) =
                    qsi[0] *
                    (3.4641016159154674 + 3.4641016159154674 * pow(qsi[0], 2) -
                     20.784609695492804 * qsi[1] +
                     20.784609695492804 * pow(qsi[1], 2) +
                     qsi[0] *
                         (-6.928203231830935 + 20.784609695492804 * qsi[1]));
                curlPhiHat(0, currentFuncPos) =
                    13.85640646366187 + 13.85640646366187 * pow(qsi[0], 2) -
                    83.13843878197122 * qsi[1] +
                    83.13843878197122 * pow(qsi[1], 2) +
                    qsi[0] * (-27.71281292732374 + 83.13843878197122 * qsi[1]);
                currentFuncPos--;
            case 2:
                phi(currentFuncPos, 0) =
                    qsi[1] * (-2.0000000018582687 + 4.000000003716537 * qsi[0] +
                              2.0000000018582687 * qsi[1]);
                phi(currentFuncPos, 1) =
                    qsi[0] * (4.000000003716537 - 4.000000003716537 * qsi[0] -
                              2.0000000018582687 * qsi[1]);
                curlPhiHat(0, currentFuncPos) = 6.000000005574806 -
                                                12.000000011149613 * qsi[0] -
                                                6.000000005574806 * qsi[1];
                currentFuncPos--;
                phi(currentFuncPos, 0) =
                    (4.000000003716872 - 2.000000001858436 * qsi[0] -
                     4.000000003716872 * qsi[1]) *
                    qsi[1];
                phi(currentFuncPos, 1) =
                    qsi[0] * (-2.000000001858436 + 2.000000001858436 * qsi[0] +
                              4.000000003716872 * qsi[1]);
                curlPhiHat(0, currentFuncPos) = -6.000000005575308 +
                                                6.000000005575308 * qsi[0] +
                                                12.000000011150616 * qsi[1];
                break;
            case 1:
                break;
            default:
                DebugStop();
                break;
            }
			break;
        default:
            DebugStop();
            break;
        }
    }
}
#endif
